"use strict";(self.webpackChunk_farmos_org_farmos_map=self.webpackChunk_farmos_org_farmos_map||[]).push([[92],{1868:(e,t,a)=>{a.r(t),a.d(t,{default:()=>L,startMeasure:()=>y,stopMeasure:()=>h});var n=a(1882),r=a(2083),o=a(2033),s=a(2706),d=a(3945);const i={},c=[];let u,f,l,m=0;function g(e){let t=e.getId();return t||(t=`measureFeature${m}`,e.setId(t),m+=1),t}function I(e,t){const a=(0,d.Yt)(t,l);let n;t instanceof o.ZP&&(n=t.getInteriorPoint().getCoordinates()),t instanceof r.Z&&(n=t.getLastCoordinate()),e.setPosition(n),e.getElement().innerHTML=a}function p(e){const t=g(e),a=document.createElement("div");a.className="ol-tooltip ol-tooltip-measure",i[t]=new n.default({element:a,offset:[0,-15],positioning:"bottom-center",stopEvent:!1}),u.addOverlay(i[t]),I(i[t],e.getGeometry())}function y(e){const t=g(e);i[t]||p(e),c[t]=e.getGeometry().on("change",(e=>I(i[t],e.target)))}function h(e=!1){c.forEach((e=>(0,s.unByKey)(e))),Object.keys(i).forEach((t=>{f.getSource().getFeatureById(t)||e&&e.getId()===t||(u.removeOverlay(i[t]),delete i[t])}))}const L={attach(e,t={}){({map:u,units:l}=e),({layer:f}=t),f.getSource().getFeatures().forEach((e=>{p(e)})),f.getSource().on("clear",(()=>{h()})),f.getSource().on("addfeature",(e=>{y(e.feature)})),e.edit&&(e.edit.addInteractionListener("drawstart",((e,t)=>{y(t.feature)})),e.edit.addInteractionListener("drawend",((e,t)=>{h(t.feature)})),e.edit.addInteractionListener("modifystart",((e,t)=>{t.features.forEach((e=>{y(e)}))})),e.edit.addInteractionListener("modifyend",(()=>{h()})),e.edit.addInteractionListener("translatestart",((e,t)=>{t.features.forEach((e=>{y(e)}))})),e.edit.addInteractionListener("translateend",(()=>{h()})),e.edit.addInteractionListener("delete",(()=>{h()})),e.edit.addInteractionListener("disable",(()=>{h()})))}}}}]);